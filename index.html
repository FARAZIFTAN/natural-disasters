<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SIG Kebencanaan - Data Gempa Real-Time BMKG</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #8b5cf6;
            --danger: #ef4444;
            --warning: #f59e0b;
            --success: #10b981;
            --info: #3b82f6;
            --dark: #1e293b;
            --light: #f8fafc;
            --gray: #64748b;
            --card-bg: rgba(255, 255, 255, 0.98);
            --glass-bg: rgba(255, 255, 255, 0.12);
            --glass-border: rgba(255, 255, 255, 0.18);
            --shadow: 0 4px 24px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 12px 40px rgba(0, 0, 0, 0.12);
            --radius: 20px;
            --radius-sm: 12px;
            --transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: var(--dark);
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 50%, rgba(99, 102, 241, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(139, 92, 246, 0.15) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 0 20px;
            position: relative;
            z-index: 1;
        }

        /* HEADER */
        header {
            padding: 24px 0 16px;
            position: relative;
            z-index: 100;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 16px;
            margin-bottom: 20px;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            width: 52px;
            height: 52px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.6rem;
            box-shadow: 0 8px 24px rgba(99, 102, 241, 0.3);
            transition: var(--transition);
        }

        .logo-icon:hover {
            transform: translateY(-3px) rotate(5deg);
            box-shadow: 0 12px 32px rgba(99, 102, 241, 0.4);
        }

        .logo-text h1 {
            font-family: 'Poppins', sans-serif;
            font-size: 1.85rem;
            font-weight: 700;
            color: white;
            line-height: 1.2;
            text-shadow: 0 3px 12px rgba(0, 0, 0, 0.25);
            letter-spacing: -0.5px;
        }

        .logo-text .subtitle {
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.88rem;
            font-weight: 400;
            margin-top: 2px;
        }

        .header-actions {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .btn {
            padding: 11px 22px;
            border-radius: var(--radius-sm);
            border: none;
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            box-shadow: 0 6px 20px rgba(99, 102, 241, 0.35);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 28px rgba(99, 102, 241, 0.45);
        }

        .btn-outline {
            background: transparent;
            color: white;
            border: 2px solid var(--glass-border);
            backdrop-filter: blur(10px);
        }

        .btn-outline:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.3);
        }

        .alert-banner {
            background: linear-gradient(90deg, rgba(247, 37, 133, 0.15), rgba(248, 150, 30, 0.15));
            border: 1px solid rgba(247, 37, 133, 0.3);
            border-radius: var(--radius-sm);
            padding: 15px 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
            animation: pulseWarning 2s infinite;
        }

        @keyframes pulseWarning {
            0% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.5); }
            50% { box-shadow: 0 0 0 15px rgba(239, 68, 68, 0); }
            100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .stat-card, .disaster-item {
            animation: fadeInUp 0.6s ease-out backwards;
        }
        
        .stat-card:nth-child(1) { animation-delay: 0.1s; }
        .stat-card:nth-child(2) { animation-delay: 0.2s; }
        .stat-card:nth-child(3) { animation-delay: 0.3s; }
        .stat-card:nth-child(4) { animation-delay: 0.4s; }

        .alert-banner i {
            color: var(--danger);
            font-size: 1.5rem;
        }

        .alert-text {
            color: white;
            flex: 1;
        }

        .alert-text strong {
            font-weight: 700;
        }

        /* STATISTICS CARDS MODERN */
        .statistics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius);
            padding: 25px;
            color: white;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            z-index: 1;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            z-index: -1;
            opacity: 0;
            transition: var(--transition);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .stat-card:hover::before {
            opacity: 1;
        }

        .stat-card i {
            font-size: 2rem;
            margin-bottom: 15px;
            opacity: 0.9;
        }

        .stat-value {
            font-size: 2.8rem;
            font-weight: 800;
            margin-bottom: 5px;
            line-height: 1;
            font-family: 'Plus Jakarta Sans', sans-serif;
        }

        .stat-label {
            font-size: 0.95rem;
            opacity: 0.9;
            font-weight: 500;
        }

        /* MAIN CONTENT LAYOUT */
        .content-wrapper {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 25px;
            margin-bottom: 40px;
        }

        @media (max-width: 1200px) {
            .content-wrapper {
                grid-template-columns: 1fr;
            }
        }

        /* MAP CONTAINER MODERN */
        .map-container {
            background: var(--card-bg);
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            position: relative;
            height: 650px;
        }

        #map {
            height: 100%;
            width: 100%;
            border-radius: var(--radius);
        }

        .map-controls {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .map-btn {
            width: 45px;
            height: 45px;
            border-radius: var(--radius-sm);
            background: white;
            border: none;
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--dark);
            font-size: 1.2rem;
            cursor: pointer;
            transition: var(--transition);
        }

        .map-btn:hover {
            background: var(--primary);
            color: white;
            transform: scale(1.05);
        }

        /* SIDEBAR MODERN */
        .sidebar {
            display: flex;
            flex-direction: column;
            height: 650px;
            background: var(--card-bg);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            overflow: hidden;
        }

        .sidebar-header {
            padding: 25px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.08);
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }

        .sidebar-header h2 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .sidebar-header p {
            opacity: 0.9;
            font-size: 0.9rem;
        }

        .disaster-list {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }

        .disaster-list::-webkit-scrollbar {
            width: 6px;
        }

        .disaster-list::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }

        .disaster-list::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 10px;
        }

        .disaster-item {
            background: white;
            border-radius: var(--radius-sm);
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            border-left: 4px solid var(--primary);
            transition: var(--transition);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .disaster-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, rgba(67, 97, 238, 0.05), transparent);
            z-index: 0;
            opacity: 0;
            transition: var(--transition);
        }

        .disaster-item:hover {
            transform: translateX(5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        }

        .disaster-item:hover::before {
            opacity: 1;
        }

        .disaster-item.earthquake { border-left-color: #f72585; }
        .disaster-item.flood { border-left-color: #4361ee; }
        .disaster-item.landslide { border-left-color: #f8961e; }
        .disaster-item.volcano { border-left-color: #7209b7; }
        .disaster-item.fire { border-left-color: #ff9e00; }

        .disaster-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }

        .disaster-title {
            font-weight: 700;
            color: var(--dark);
            font-size: 1.05rem;
            line-height: 1.3;
        }

        .disaster-badge {
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            color: white;
            white-space: nowrap;
        }

        .badge-viral {
            background: linear-gradient(90deg, var(--danger), #ff6b9d);
        }

        .badge-active {
            background: linear-gradient(90deg, var(--warning), #ffb143);
        }

        .badge-ongoing {
            background: linear-gradient(90deg, #4cc9f0, #6dd5fa);
        }

        .disaster-meta {
            display: flex;
            justify-content: space-between;
            font-size: 0.85rem;
            color: var(--gray);
            margin-top: 12px;
            position: relative;
            z-index: 1;
        }

        .disaster-location {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* FILTER BAR */
        .filter-bar {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 10px 20px;
            border-radius: 30px;
            background: white;
            border: 1px solid #e0e0e0;
            color: var(--gray);
            font-weight: 500;
            font-size: 0.9rem;
            cursor: pointer;
            transition: var(--transition);
        }

        .filter-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .filter-btn:hover:not(.active) {
            border-color: var(--primary);
            color: var(--primary);
        }

        /* SOCIAL SHARE MODERN */
        .social-share {
            background: var(--card-bg);
            border-radius: var(--radius);
            padding: 30px;
            margin-bottom: 40px;
            box-shadow: var(--shadow);
        }

        .social-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .social-header h3 {
            font-size: 1.5rem;
            color: var(--dark);
            font-weight: 700;
        }

        .social-icons {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
        }

        .social-icon {
            width: 60px;
            height: 60px;
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            text-decoration: none;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .social-icon::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.2), transparent);
            opacity: 0;
            transition: var(--transition);
        }

        .social-icon:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }

        .social-icon:hover::before {
            opacity: 1;
        }

        .social-icon.whatsapp { background: linear-gradient(135deg, #25D366, #128C7E); }
        .social-icon.instagram { background: linear-gradient(135deg, #405DE6, #833AB4, #C13584, #E1306C, #FD1D1D); }
        .social-icon.tiktok { background: linear-gradient(135deg, #000000, #25F4EE, #FE2C55); }
        .social-icon.linkedin { background: linear-gradient(135deg, #0077B5, #00A0DC); }
        .social-icon.facebook { background: linear-gradient(135deg, #1877F2, #0A5FA0); }
        .social-icon.twitter { background: linear-gradient(135deg, #1DA1F2, #0D8BD9); }

        /* DETAIL MODAL */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            z-index: 2000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal-content {
            background: white;
            border-radius: var(--radius);
            width: 100%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.3);
            animation: modalFadeIn 0.3s ease-out;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .modal-header {
            padding: 25px 30px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border-radius: var(--radius) var(--radius) 0 0;
        }

        .modal-header h3 {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .modal-close {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .modal-body {
            padding: 30px;
        }

        /* FOOTER MODERN */
        footer {
            text-align: center;
            padding: 30px 0;
            color: rgba(255, 255, 255, 0.7);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            margin-top: 20px;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .footer-link {
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
        }

        .footer-link:hover {
            color: white;
        }

        .copyright {
            font-size: 0.9rem;
        }

        /* LOADING STATE */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* RESPONSIVE DESIGN */
        @media (max-width: 1200px) {
            .content-wrapper {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                order: -1;
                height: 400px;
            }
        }

        @media (max-width: 992px) {
            .container {
                padding: 0 16px;
            }
            
            .header-content {
                gap: 12px;
            }
            
            .logo-text h1 {
                font-size: 1.6rem;
            }
            
            .logo-text .subtitle {
                font-size: 0.8rem;
            }
            
            .header-actions {
                width: 100%;
                flex-wrap: wrap;
            }
            
            .btn {
                flex: 1;
                min-width: 140px;
                justify-content: center;
                padding: 10px 16px;
                font-size: 0.85rem;
            }
            
            .statistics {
                grid-template-columns: repeat(2, 1fr);
                gap: 16px;
            }
            
            .stat-card {
                padding: 20px;
            }
            
            .stat-value {
                font-size: 2.4rem;
            }
            
            .filter-bar {
                gap: 8px;
            }
            
            .filter-btn {
                padding: 8px 16px;
                font-size: 0.85rem;
            }
            
            .map-container {
                height: 500px;
            }
            
            .social-share {
                padding: 24px;
            }
        }

        @media (max-width: 768px) {
            header {
                padding: 20px 0 16px;
            }
            
            .logo-icon {
                width: 44px;
                height: 44px;
                font-size: 1.3rem;
            }
            
            .logo-text h1 {
                font-size: 1.4rem;
            }
            
            .logo-text .subtitle {
                font-size: 0.75rem;
            }
            
            .alert-banner {
                flex-direction: column;
                text-align: center;
                padding: 16px;
            }
            
            .alert-banner i {
                font-size: 2rem;
            }
            
            .statistics {
                grid-template-columns: 1fr;
                gap: 12px;
            }
            
            .stat-card {
                padding: 18px;
            }
            
            .stat-card i {
                font-size: 1.8rem;
            }
            
            .stat-value {
                font-size: 2.2rem;
            }
            
            .stat-label {
                font-size: 0.88rem;
            }
            
            .filter-bar {
                gap: 6px;
            }
            
            .filter-btn {
                padding: 8px 14px;
                font-size: 0.8rem;
            }
            
            .map-container {
                height: 400px;
            }
            
            .sidebar {
                height: 350px;
            }
            
            .sidebar-header {
                padding: 20px;
            }
            
            .sidebar-header h2 {
                font-size: 1.3rem;
            }
            
            .disaster-list {
                padding: 16px;
            }
            
            .disaster-item {
                padding: 16px;
            }
            
            .disaster-title {
                font-size: 0.95rem;
            }
            
            .social-share {
                padding: 20px;
            }
            
            .social-header h3 {
                font-size: 1.3rem;
            }
            
            .social-icons {
                gap: 10px;
            }
            
            .social-icon {
                width: 52px;
                height: 52px;
                font-size: 1.3rem;
            }
            
            .modal-content {
                max-width: 95%;
            }
            
            .modal-header {
                padding: 20px;
            }
            
            .modal-header h3 {
                font-size: 1.3rem;
            }
            
            .modal-body {
                padding: 20px;
            }
            
            footer {
                padding: 24px 0;
            }
            
            .footer-links {
                flex-direction: column;
                gap: 12px;
            }
        }

        @media (max-width: 480px) {
            .logo-container {
                gap: 10px;
            }
            
            .logo-text h1 {
                font-size: 1.2rem;
            }
            
            .logo-text .subtitle {
                display: none;
            }
            
            .header-actions {
                gap: 8px;
            }
            
            .btn {
                padding: 9px 12px;
                font-size: 0.8rem;
            }
            
            .btn span {
                display: none;
            }
            
            .stat-card {
                padding: 16px;
            }
            
            .map-controls {
                top: 12px;
                right: 12px;
                gap: 8px;
            }
            
            .map-btn {
                width: 40px;
                height: 40px;
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="background-animation"></div>
    
    <div class="container">
        <!-- HEADER -->
        <header>
            <div class="header-content">
                <div class="logo-container">
                    <div class="logo-icon">
                        <i class="fas fa-map-marked-alt"></i>
                    </div>
                    <div class="logo-text">
                        <h1>SIG KEBENCANAAN</h1>
                        <div class="subtitle">Sistem Informasi Geografis Pemantauan Bencana Terkini</div>
                    </div>
                </div>
                
                <div class="header-actions">
                    <button class="btn btn-outline">
                        <i class="fas fa-download"></i> Laporan PDF
                    </button>
                    <button class="btn btn-primary" id="refreshData">
                        <i class="fas fa-sync-alt"></i> Perbarui Data
                    </button>
                </div>
            </div>
            
            <div class="alert-banner animate__animated animate__pulse animate__infinite">
                <i class="fas fa-exclamation-triangle"></i>
                <div class="alert-text">
                    <strong>PERINGATAN:</strong> Terdapat 3 bencana aktif yang memerlukan perhatian segera. Warga diimbau tetap waspada dan ikuti informasi terbaru.
                </div>
                <button class="btn btn-outline" style="padding: 8px 16px; font-size: 0.85rem;">
                    Info Selengkapnya
                </button>
            </div>
        </header>
        
        <!-- STATISTICS -->
        <div class="statistics">
            <div class="stat-card">
                <i class="fas fa-exclamation-triangle" style="color: #f72585;"></i>
                <div class="stat-value" id="total-disasters">14</div>
                <div class="stat-label">Total Bencana Dilaporkan</div>
            </div>
            <div class="stat-card">
                <i class="fas fa-fire" style="color: #f8961e;"></i>
                <div class="stat-value" id="active-disasters">6</div>
                <div class="stat-label">Bencana Aktif</div>
            </div>
            <div class="stat-card">
                <i class="fas fa-users" style="color: #4cc9f0;"></i>
                <div class="stat-value" id="affected-people">42.7K</div>
                <div class="stat-label">Orang Terdampak</div>
            </div>
            <div class="stat-card">
                <i class="fas fa-clock" style="color: #7209b7;"></i>
                <div class="stat-value" id="latest-update">24</div>
                <div class="stat-label">Jam Terakhir</div>
            </div>
        </div>
        
        <!-- FILTER BAR -->
        <div class="filter-bar">
            <button class="filter-btn active" data-filter="all">Semua Bencana</button>
            <button class="filter-btn" data-filter="earthquake">Gempa Bumi</button>
            <button class="filter-btn" data-filter="flood">Banjir</button>
            <button class="filter-btn" data-filter="landslide">Tanah Longsor</button>
            <button class="filter-btn" data-filter="volcano">Gunung Berapi</button>
            <button class="filter-btn" data-filter="fire">Kebakaran</button>
            <button class="filter-btn" data-filter="viral">Sedang Viral</button>
        </div>
        
        <!-- MAIN CONTENT -->
        <div class="content-wrapper">
            <!-- MAP SECTION -->
            <div class="map-container">
                <div id="map"></div>
                
                <div class="map-controls">
                    <button class="map-btn" id="zoomIn">
                        <i class="fas fa-plus"></i>
                    </button>
                    <button class="map-btn" id="zoomOut">
                        <i class="fas fa-minus"></i>
                    </button>
                    <button class="map-btn" id="locateMe">
                        <i class="fas fa-location-crosshairs"></i>
                    </button>
                    <button class="map-btn" id="fullscreen">
                        <i class="fas fa-expand"></i>
                    </button>
                </div>
            </div>
            
            <!-- SIDEBAR -->
            <div class="sidebar">
                <div class="sidebar-header">
                    <h2><i class="fas fa-list"></i> Daftar Bencana Terkini</h2>
                    <p>Data diperbarui secara real-time dari sumber terpercaya</p>
                </div>
                
                <div class="disaster-list" id="disasterList">
                    <!-- Disaster items will be inserted here by JavaScript -->
                </div>
            </div>
        </div>
        
        <!-- SOCIAL SHARE -->
        <div class="social-share">
            <div class="social-header">
                <h3>Bagikan Informasi Penting Ini</h3>
                <p style="color: var(--gray); font-size: 0.9rem;">Bantu sebarkan kesadaran kebencanaan</p>
            </div>
            
            <div class="social-icons">
                <a href="#" class="social-icon whatsapp" id="shareWA">
                    <i class="fab fa-whatsapp"></i>
                </a>
                <a href="#" class="social-icon instagram" id="shareIG">
                    <i class="fab fa-instagram"></i>
                </a>
                <a href="#" class="social-icon tiktok" id="shareTikTok">
                    <i class="fab fa-tiktok"></i>
                </a>
                <a href="#" class="social-icon linkedin" id="shareLinkedIn">
                    <i class="fab fa-linkedin-in"></i>
                </a>
                <a href="#" class="social-icon facebook" id="shareFB">
                    <i class="fab fa-facebook-f"></i>
                </a>
                <a href="#" class="social-icon twitter" id="shareTwitter">
                    <i class="fab fa-twitter"></i>
                </a>
            </div>
        </div>
        
        <!-- FOOTER -->
        <footer>
            <div class="footer-links">
                <a href="#" class="footer-link">Tentang Sistem</a>
                <a href="#" class="footer-link">Sumber Data</a>
                <a href="#" class="footer-link">Kontak Darurat</a>
                <a href="#" class="footer-link">Panduan Evakuasi</a>
                <a href="#" class="footer-link">Kebijakan Privasi</a>
            </div>
            <div class="copyright">
                <p>&copy; 2025 SIG Kebencanaan. Hak Cipta Dilindungi. Data real-time dari BMKG.</p>
                <p style="margin-top: 10px; font-size: 0.8rem;">Sistem ini merupakan bagian dari inisiatif meningkatkan kesadaran kebencanaan masyarakat.</p>
            </div>
        </footer>
    </div>
    
    <!-- MODAL DETAIL -->
    <div class="modal-overlay" id="detailModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Detail Bencana</h3>
                <button class="modal-close" id="closeModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body" id="modalBody">
                <!-- Modal content will be inserted here -->
            </div>
        </div>
    </div>

    <script>
        // INISIALISASI PETA
        const map = L.map('map', {
            zoomControl: false,
            fadeAnimation: true,
            zoomAnimation: true
        }).setView([-2.5489, 118.0149], 5);
        
        // TILE LAYER MODERN
        L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> | <a href="https://carto.com/attributions">CARTO</a> | Data: BMKG',
            subdomains: 'abcd',
            maxZoom: 19
        }).addTo(map);
        
        L.control.zoom({
            position: 'bottomright'
        }).addTo(map);
        
        // STORAGE UNTUK DATA BENCANA
        let disasters = [];
        let markers = [];
        
        // API BMKG GEMPA TERKINI
        const BMKG_API_URL = 'https://data.bmkg.go.id/DataMKG/TEWS/';
        const GEMPA_TERKINI = BMKG_API_URL + 'gempaterkini.json';
        const AUTO_GEMPA = BMKG_API_URL + 'autogempa.json';

        // FUNGSI FETCH DATA DARI BMKG
        async function fetchBMKGData() {
            try {
                showNotification('Memuat data real-time dari BMKG...', 'info');
                
                // Fetch data gempa terkini
                const response = await fetch(GEMPA_TERKINI);
                
                if (!response.ok) {
                    throw new Error('Gagal mengambil data dari BMKG');
                }
                
                const data = await response.json();
                const gempaData = data.Infogempa.gempa;
                
                // Clear existing disasters and markers
                disasters = [];
                clearMarkers();
                
                // Convert BMKG data ke format aplikasi
                gempaData.forEach((gempa, index) => {
                    const coordinates = parseCoordinates(gempa.Coordinates);
                    
                    disasters.push({
                        id: index + 1,
                        title: `Gempa ${gempa.Magnitude} SR - ${gempa.Wilayah}`,
                        location: gempa.Wilayah,
                        coordinates: coordinates,
                        type: 'earthquake',
                        date: formatDate(gempa.Tanggal),
                        time: gempa.Jam,
                        status: getStatus(gempa.DateTime),
                        details: `Gempa bumi berkekuatan ${gempa.Magnitude} SR terjadi di ${gempa.Wilayah}. Kedalaman: ${gempa.Kedalaman}. ${gempa.Potensi}`,
                        magnitude: parseFloat(gempa.Magnitude),
                        depth: gempa.Kedalaman,
                        potential: gempa.Potensi,
                        affected: estimateAffected(gempa.Magnitude),
                        severity: getSeverity(gempa.Magnitude),
                        viral: parseFloat(gempa.Magnitude) >= 5.5,
                        trend: parseFloat(gempa.Magnitude) >= 5.5 ? '#Gempa trending di Media Sosial' : '',
                        updates: [
                            {time: gempa.Jam, desc: `Gempa ${gempa.Magnitude} SR terjadi di ${gempa.Wilayah}`},
                            {time: gempa.Jam, desc: `Kedalaman: ${gempa.Kedalaman}`},
                            {time: gempa.Jam, desc: gempa.Potensi}
                        ],
                        source: 'BMKG',
                        shakemap: gempa.Shakemap || null
                    });
                });
                
                // Sort by magnitude (terbesar dulu)
                disasters.sort((a, b) => b.magnitude - a.magnitude);
                
                // Render data
                renderDisasterList();
                addMarkersToMap();
                updateStatistics();
                
                showNotification(`Berhasil memuat ${disasters.length} data gempa dari BMKG`, 'success');
                
            } catch (error) {
                console.error('Error fetching BMKG data:', error);
                showNotification('Gagal memuat data dari BMKG. Menggunakan data cache.', 'error');
                loadFallbackData();
            }
        }
        
        // FUNGSI PARSE KOORDINAT DARI BMKG (FORMAT: "lat,lon")
        function parseCoordinates(coordString) {
            const parts = coordString.split(',');
            return [parseFloat(parts[0]), parseFloat(parts[1])];
        }
        
        // FUNGSI FORMAT TANGGAL
        function formatDate(dateString) {
            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'Mei', 'Jun', 'Jul', 'Agu', 'Sep', 'Okt', 'Nov', 'Des'];
            const parts = dateString.split(' ');
            const day = parts[0];
            const monthIndex = months.findIndex(m => m.toLowerCase() === parts[1].toLowerCase());
            const monthName = months[monthIndex] || parts[1];
            const year = parts[2];
            return `${day} ${monthName} ${year}`;
        }
        
        // FUNGSI TENTUKAN STATUS BERDASARKAN WAKTU
        function getStatus(datetime) {
            const eventDate = new Date(datetime);
            const now = new Date();
            const diffHours = (now - eventDate) / (1000 * 60 * 60);
            
            if (diffHours < 2) return 'active';
            if (diffHours < 24) return 'ongoing';
            return 'resolved';
        }
        
        // ESTIMASI JUMLAH TERDAMPAK BERDASARKAN MAGNITUDE
        function estimateAffected(magnitude) {
            const mag = parseFloat(magnitude);
            if (mag >= 7.0) return '50.000+ orang';
            if (mag >= 6.0) return '10.000+ orang';
            if (mag >= 5.5) return '5.000+ orang';
            if (mag >= 5.0) return '1.000+ orang';
            return '500+ orang';
        }
        
        // TENTUKAN SEVERITY
        function getSeverity(magnitude) {
            const mag = parseFloat(magnitude);
            if (mag >= 7.0) return 'Sangat Tinggi';
            if (mag >= 6.0) return 'Tinggi';
            if (mag >= 5.5) return 'Sedang';
            return 'Rendah';
        }
        
        // CLEAR ALL MARKERS
        function clearMarkers() {
            markers.forEach(m => map.removeLayer(m.marker));
            markers = [];
        }
        
        // FALLBACK DATA JIKA API GAGAL
        function loadFallbackData() {
            disasters = [
            {
                id: 1,
                title: "Gempa 5.2 SR - Laut Banda",
                location: "Laut Banda",
                coordinates: [-5.5, 127.5],
                type: "earthquake",
                date: "12 Des 2025",
                time: "08:32 WIB",
                status: "ongoing",
                details: "Gempa bumi berkekuatan 5.2 SR terjadi di Laut Banda. Kedalaman 10 km. Tidak berpotensi tsunami.",
                magnitude: 5.2,
                affected: "1.000+ orang",
                severity: "Sedang",
                viral: false,
                trend: "",
                updates: [
                    {time: "08:32 WIB", desc: "Gempa 5.2 SR terjadi di Laut Banda"},
                    {time: "08:32 WIB", desc: "Kedalaman: 10 km"}
                ]
            },
            {
                id: 2,
                title: "Gempa 4.8 SR - Maluku Utara",
                location: "Maluku Utara",
                coordinates: [0.5, 127.8],
                type: "earthquake",
                date: "12 Des 2025",
                time: "06:15 WIT",
                status: "resolved",
                details: "Gempa bumi berkekuatan 4.8 SR terjadi di Maluku Utara. Kedalaman 20 km. Tidak berpotensi tsunami.",
                magnitude: 4.8,
                affected: "500+ orang",
                severity: "Rendah",
                viral: false,
                trend: "",
                updates: [
                    {time: "06:15 WIT", desc: "Gempa 4.8 SR terjadi"}
                ]
            }
        ];
        
            renderDisasterList();
            addMarkersToMap();
            updateStatistics();
        }
        
        // KONFIGURASI WARNA & IKON
        const disasterColors = {
            earthquake: '#f72585',
            flood: '#4361ee',
            landslide: '#f8961e',
            volcano: '#7209b7',
            fire: '#ff9e00'
        };
        
        // Ikon untuk setiap jenis bencana
        const disasterIcons = {
            earthquake: 'fa-mountain',
            flood: 'fa-water',
            landslide: 'fa-hill-rockslide',
            volcano: 'fa-volcano',
            fire: 'fa-fire'
        };
        
        // FUNGSI CREATE CUSTOM MARKER ICON
        function createCustomIcon(disaster) {
            return L.divIcon({
                html: `
                    <div class="marker-container" style="position: relative;">
                        <div style="
                            width: 32px; 
                            height: 32px; 
                            background: ${disasterColors[disaster.type]};
                            border-radius: 50%; 
                            display: flex; 
                            align-items: center; 
                            justify-content: center;
                            color: white;
                            font-size: 14px;
                            box-shadow: 0 4px 12px ${disasterColors[disaster.type]}80;
                            border: 3px solid white;
                            transform: scale(${disaster.viral ? '1.1' : '1'});
                            animation: ${disaster.status === 'active' ? 'pulse 1.5s infinite' : 'none'};
                        ">
                            <i class="fas ${disasterIcons[disaster.type]}"></i>
                        </div>
                        ${disaster.viral ? `
                            <div style="
                                position: absolute;
                                top: -5px;
                                right: -5px;
                                width: 16px;
                                height: 16px;
                                background: #f72585;
                                border-radius: 50%;
                                border: 2px solid white;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                            ">
                                <i class="fas fa-fire" style="font-size: 8px; color: white;"></i>
                            </div>
                        ` : ''}
                    </div>
                `,
                iconSize: [40, 40],
                className: 'custom-marker'
            });
        }
        
        // FUNGSI TAMBAH MARKERS KE PETA
        function addMarkersToMap() {
            clearMarkers();
            
            disasters.forEach(disaster => {
            const marker = L.marker(disaster.coordinates, {
                icon: createCustomIcon(disaster)
            }).addTo(map);
            
            // Popup dengan desain modern
            marker.bindPopup(`
                <div style="font-family: 'Inter', sans-serif; min-width: 280px;">
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                        <div style="width: 12px; height: 12px; background: ${disasterColors[disaster.type]}; border-radius: 50%;"></div>
                        <h3 style="margin: 0; color: ${disasterColors[disaster.type]}; font-weight: 700; font-size: 1.1rem;">${disaster.title}</h3>
                    </div>
                    <p style="margin: 0 0 8px; color: #555; font-size: 0.9rem;"><i class="fas fa-map-marker-alt" style="margin-right: 5px;"></i> ${disaster.location}</p>
                    <p style="margin: 0 0 8px; color: #555; font-size: 0.9rem;"><i class="fas fa-calendar" style="margin-right: 5px;"></i> ${disaster.date} | ${disaster.time}</p>
                    <p style="margin: 0 0 12px; color: #555; font-size: 0.9rem;"><i class="fas fa-users" style="margin-right: 5px;"></i> ${disaster.affected} terdampak</p>
                    <div style="display: flex; gap: 8px; margin-bottom: 12px;">
                        <span style="background: ${disaster.status === 'active' ? '#ffebee' : disaster.status === 'ongoing' ? '#fff3e0' : '#e8f5e9'}; color: ${disaster.status === 'active' ? '#d32f2f' : disaster.status === 'ongoing' ? '#f57c00' : '#388e3c'}; padding: 4px 10px; border-radius: 20px; font-size: 0.8rem; font-weight: 600;">
                            ${disaster.status === 'active' ? 'AKTIF' : disaster.status === 'ongoing' ? 'BERLANGSUNG' : 'SELESAI'}
                        </span>
                        ${disaster.viral ? `<span style="background: #f72585; color: white; padding: 4px 10px; border-radius: 20px; font-size: 0.8rem; font-weight: 600;">VIRAL</span>` : ''}
                    </div>
                    <button onclick="openDisasterDetail(${disaster.id})" style="background: ${disasterColors[disaster.type]}; color: white; border: none; padding: 8px 16px; border-radius: 6px; font-family: 'Inter', sans-serif; font-weight: 600; cursor: pointer; width: 100%;">
                        <i class="fas fa-info-circle" style="margin-right: 5px;"></i> Detail Lengkap
                    </button>
                </div>
            `);
            
                markers.push({
                    marker: marker,
                    disaster: disaster
                });
            });
        }
        
        // FUNGSI RENDER DISASTER LIST
        function renderDisasterList(filter = 'all') {
            const disasterList = document.getElementById('disasterList');
            disasterList.innerHTML = '';
            
            const filteredDisasters = disasters.filter(disaster => {
                if (filter === 'all') return true;
                if (filter === 'viral') return disaster.viral;
                return disaster.type === filter;
            });
            
            filteredDisasters.forEach(disaster => {
                const disasterItem = document.createElement('div');
                disasterItem.className = `disaster-item ${disaster.type}`;
                disasterItem.setAttribute('data-id', disaster.id);
                disasterItem.setAttribute('data-type', disaster.type);
                disasterItem.setAttribute('data-viral', disaster.viral);
                
                disasterItem.innerHTML = `
                    <div class="disaster-header">
                        <div class="disaster-title">${disaster.title}</div>
                        <div class="disaster-badge ${disaster.status === 'active' ? 'badge-active' : disaster.status === 'ongoing' ? 'badge-ongoing' : ''}">
                            ${disaster.status === 'active' ? 'AKTIF' : disaster.status === 'ongoing' ? 'BERLANGSUNG' : 'SELESAI'}
                        </div>
                    </div>
                    <div style="font-size: 0.9rem; color: #666; margin-bottom: 8px; display: flex; align-items: center; gap: 5px;">
                        <i class="fas fa-map-marker-alt"></i> ${disaster.location}
                    </div>
                    <div style="font-size: 0.85rem; color: #888; margin-bottom: 12px; display: flex; align-items: center; gap: 5px;">
                        <i class="fas fa-clock"></i> ${disaster.date} | ${disaster.time}
                    </div>
                    <div class="disaster-meta">
                        <div style="display: flex; align-items: center; gap: 5px;">
                            <i class="fas fa-users"></i>
                            <span>${disaster.affected}</span>
                        </div>
                        <div>
                            ${disaster.viral ? `<span class="disaster-badge badge-viral" style="font-size: 0.7rem; padding: 3px 8px;">VIRAL</span>` : ''}
                        </div>
                    </div>
                `;
                
                // Event listener untuk menampilkan popup di peta saat item diklik
                disasterItem.addEventListener('click', () => {
                    markers.forEach(m => {
                        if (m.disaster.id === disaster.id) {
                            m.marker.openPopup();
                            map.setView(m.disaster.coordinates, 9, {
                                animate: true,
                                duration: 1
                            });
                        }
                    });
                });
                
                disasterList.appendChild(disasterItem);
            });
        }
        
        // FUNGSI UPDATE STATISTIK
        function updateStatistics() {
            const totalDisasters = disasters.length;
            const activeDisasters = disasters.filter(d => d.status === 'active' || d.status === 'ongoing').length;
            
            // Hitung total affected
            let totalAffected = 0;
            disasters.forEach(d => {
                const affectedNum = parseInt(d.affected.replace(/[^0-9]/g, ''));
                totalAffected += affectedNum;
            });
            
            // Animate values
            animateValue(document.getElementById('total-disasters'), 0, totalDisasters, 1000);
            animateValue(document.getElementById('active-disasters'), 0, activeDisasters, 1000);
            animateValue(document.getElementById('affected-people'), 0, (totalAffected / 1000).toFixed(1), 1000);
        }
        
        // EVENT LISTENERS - FILTER
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                renderDisasterList(this.getAttribute('data-filter'));
            });
        });
        
        // Map controls functionality
        document.getElementById('zoomIn').addEventListener('click', () => {
            map.zoomIn();
        });
        
        document.getElementById('zoomOut').addEventListener('click', () => {
            map.zoomOut();
        });
        
        document.getElementById('locateMe').addEventListener('click', () => {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(position => {
                    const { latitude, longitude } = position.coords;
                    map.setView([latitude, longitude], 12, {
                        animate: true,
                        duration: 1.5
                    });
                    
                    // Tambahkan marker lokasi pengguna
                    L.marker([latitude, longitude], {
                        icon: L.divIcon({
                            html: '<div style="background: #4cc9f0; width: 24px; height: 24px; border-radius: 50%; border: 3px solid white; box-shadow: 0 0 10px rgba(0,0,0,0.3);"></div>',
                            iconSize: [30, 30]
                        })
                    }).addTo(map)
                    .bindPopup('<b>Lokasi Anda</b><br>Anda berada di sini.')
                    .openPopup();
                });
            } else {
                alert('Geolocation tidak didukung oleh browser Anda.');
            }
        });
        
        document.getElementById('fullscreen').addEventListener('click', () => {
            const mapContainer = document.getElementById('map');
            if (!document.fullscreenElement) {
                if (mapContainer.requestFullscreen) {
                    mapContainer.requestFullscreen();
                } else if (mapContainer.webkitRequestFullscreen) {
                    mapContainer.webkitRequestFullscreen();
                } else if (mapContainer.msRequestFullscreen) {
                    mapContainer.msRequestFullscreen();
                }
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                } else if (document.webkitExitFullscreen) {
                    document.webkitExitFullscreen();
                } else if (document.msExitFullscreen) {
                    document.msExitFullscreen();
                }
            }
        });
        
        // EVENT LISTENER - REFRESH DATA
        document.getElementById('refreshData').addEventListener('click', async function() {
            const btn = this;
            const originalHTML = btn.innerHTML;
            
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Memperbarui...';
            btn.disabled = true;
            
            try {
                await fetchBMKGData();
                
                // Update last update time
                const now = new Date();
                const minutes = Math.floor(Math.random() * 30) + 1;
                document.getElementById('latest-update').textContent = minutes;
                
            } catch (error) {
                showNotification('Gagal memperbarui data', 'error');
            } finally {
                btn.innerHTML = originalHTML;
                btn.disabled = false;
            }
        });
        
        // Fungsi untuk membuka detail bencana di modal
        window.openDisasterDetail = function(id) {
            const disaster = disasters.find(d => d.id === id);
            if (!disaster) return;
            
            document.getElementById('modalTitle').textContent = disaster.title;
            
            const modalBody = document.getElementById('modalBody');
            modalBody.innerHTML = `
                <div style="display: flex; gap: 20px; margin-bottom: 25px; flex-wrap: wrap;">
                    <div style="flex: 1; min-width: 200px;">
                        <div style="margin-bottom: 15px;">
                            <div style="font-size: 0.9rem; color: #888; margin-bottom: 5px;">Lokasi</div>
                            <div style="font-weight: 600; display: flex; align-items: center; gap: 8px;">
                                <i class="fas fa-map-marker-alt" style="color: ${disasterColors[disaster.type]}"></i>
                                ${disaster.location}
                            </div>
                        </div>
                        <div style="margin-bottom: 15px;">
                            <div style="font-size: 0.9rem; color: #888; margin-bottom: 5px;">Waktu Kejadian</div>
                            <div style="font-weight: 600; display: flex; align-items: center; gap: 8px;">
                                <i class="fas fa-calendar" style="color: ${disasterColors[disaster.type]}"></i>
                                ${disaster.date} | ${disaster.time}
                            </div>
                        </div>
                        <div style="margin-bottom: 15px;">
                            <div style="font-size: 0.9rem; color: #888; margin-bottom: 5px;">Orang Terdampak</div>
                            <div style="font-weight: 600; display: flex; align-items: center; gap: 8px;">
                                <i class="fas fa-users" style="color: ${disasterColors[disaster.type]}"></i>
                                ${disaster.affected}
                            </div>
                        </div>
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <div style="margin-bottom: 15px;">
                            <div style="font-size: 0.9rem; color: #888; margin-bottom: 5px;">Status</div>
                            <div>
                                <span style="background: ${disaster.status === 'active' ? '#ffebee' : disaster.status === 'ongoing' ? '#fff3e0' : '#e8f5e9'}; color: ${disaster.status === 'active' ? '#d32f2f' : disaster.status === 'ongoing' ? '#f57c00' : '#388e3c'}; padding: 6px 15px; border-radius: 20px; font-size: 0.9rem; font-weight: 600;">
                                    ${disaster.status === 'active' ? 'AKTIF' : disaster.status === 'ongoing' ? 'BERLANGSUNG' : 'SELESAI'}
                                </span>
                            </div>
                        </div>
                        <div style="margin-bottom: 15px;">
                            <div style="font-size: 0.9rem; color: #888; margin-bottom: 5px;">Tingkat Keparahan</div>
                            <div style="font-weight: 600; color: ${disasterColors[disaster.type]}">${disaster.severity}</div>
                        </div>
                        ${disaster.viral ? `
                            <div style="margin-bottom: 15px;">
                                <div style="font-size: 0.9rem; color: #888; margin-bottom: 5px;">Trend Media Sosial</div>
                                <div style="font-weight: 600; color: #f72585; display: flex; align-items: center; gap: 8px;">
                                    <i class="fas fa-fire"></i>
                                    ${disaster.trend}
                                </div>
                            </div>
                        ` : ''}
                    </div>
                </div>
                
                <div style="margin-bottom: 25px;">
                    <div style="font-size: 0.9rem; color: #888; margin-bottom: 10px;">Deskripsi</div>
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; line-height: 1.6;">
                        ${disaster.details}
                    </div>
                </div>
                
                <div>
                    <div style="font-size: 0.9rem; color: #888; margin-bottom: 10px;">Perkembangan Terkini</div>
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                        ${disaster.updates.map(update => `
                            <div style="display: flex; gap: 15px; margin-bottom: 12px; padding-bottom: 12px; border-bottom: 1px solid #eee; align-items: flex-start;">
                                <div style="background: ${disasterColors[disaster.type]}; color: white; padding: 5px 12px; border-radius: 20px; font-size: 0.8rem; font-weight: 600; white-space: nowrap;">
                                    ${update.time}
                                </div>
                                <div style="flex: 1;">${update.desc}</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            
            // Tampilkan modal
            document.getElementById('detailModal').style.display = 'flex';
            
            // Fokus ke marker di peta
            markers.forEach(m => {
                if (m.disaster.id === id) {
                    m.marker.openPopup();
                    map.setView(m.disaster.coordinates, 9, {
                        animate: true,
                        duration: 1
                    });
                }
            });
        };
        
        // Tutup modal
        document.getElementById('closeModal').addEventListener('click', function() {
            document.getElementById('detailModal').style.display = 'none';
        });
        
        // Tutup modal saat klik di luar konten modal
        document.getElementById('detailModal').addEventListener('click', function(e) {
            if (e.target === this) {
                this.style.display = 'none';
            }
        });
        
        // FUNGSI ANIMASI NILAI
        function animateValue(element, start, end, duration) {
            if (!element) return;
            let startTimestamp = null;
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                const value = progress * (end - start) + start;
                element.textContent = typeof end === 'number' && end % 1 !== 0 ? value.toFixed(1) : Math.floor(value);
                if (progress < 1) {
                    window.requestAnimationFrame(step);
                }
            };
            window.requestAnimationFrame(step);
        }
        
        // FUNGSI NOTIFIKASI
        function showNotification(message, type = 'info') {
            // Hapus notifikasi sebelumnya
            const existingNotification = document.querySelector('.notification');
            if (existingNotification) existingNotification.remove();
            
            // Buat elemen notifikasi
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'success' ? '#4CAF50' : type === 'error' ? '#f44336' : '#2196F3'};
                color: white;
                padding: 15px 25px;
                border-radius: 8px;
                box-shadow: 0 10px 25px rgba(0,0,0,0.2);
                z-index: 3000;
                font-weight: 500;
                display: flex;
                align-items: center;
                gap: 10px;
                animation: slideIn 0.3s ease-out;
            `;
            
            notification.innerHTML = `
                <i class="fas ${type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-exclamation-circle' : 'fa-info-circle'}"></i>
                ${message}
            `;
            
            document.body.appendChild(notification);
            
            // Hapus notifikasi setelah 3 detik
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease-out';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }
        
        // Tambahkan CSS untuk animasi notifikasi
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
            
            @keyframes pulse {
                0% { transform: scale(1); }
                50% { transform: scale(1.1); }
                100% { transform: scale(1); }
            }
        `;
        document.head.appendChild(style);
        
        // Setup sharing buttons
        const shareText = "Sistem Informasi Geografis Kebencanaan - Pantau bencana alam terkini yang sedang viral di media sosial. Data real-time dan akurat.";
        const shareUrl = window.location.href;
        
        document.getElementById('shareWA').href = `https://wa.me/?text=${encodeURIComponent(shareText + " " + shareUrl)}`;
        document.getElementById('shareIG').href = `https://www.instagram.com/share?url=${encodeURIComponent(shareUrl)}&caption=${encodeURIComponent(shareText)}`;
        document.getElementById('shareTikTok').href = `https://www.tiktok.com/share?url=${encodeURIComponent(shareUrl)}`;
        document.getElementById('shareLinkedIn').href = `https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(shareUrl)}`;
        document.getElementById('shareFB').href = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(shareUrl)}`;
        document.getElementById('shareTwitter').href = `https://twitter.com/intent/tweet?text=${encodeURIComponent(shareText)}&url=${encodeURIComponent(shareUrl)}`;
        
        // INIT - LOAD DATA SAAT HALAMAN DIBUKA
        window.addEventListener('DOMContentLoaded', () => {
            showNotification('Selamat datang di SIG Kebencanaan!', 'info');
            fetchBMKGData();
        });
        
        // AUTO REFRESH SETIAP 5 MENIT
        setInterval(() => {
            fetchBMKGData();
            showNotification('Data diperbarui otomatis', 'info');
        }, 5 * 60 * 1000);
    </script>
</body>
</html>